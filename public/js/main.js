(()=>{"use strict";var e={d:(t,s)=>{for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{Z:()=>n});const t={authAs:"",form:document.querySelector(".form"),header:document.querySelector("h1"),loginInput:document.querySelector('input[placeholder="Email"]'),passInput:document.querySelector('input[placeholder="Password"]'),button:document.querySelector('input[type="submit"]'),link:document.querySelector("a"),init:()=>{t.form.style.display="block",t.addEventListeners()},addEventListeners:function(){t.button.addEventListener("click",(()=>{if("login"===t.form.classList[1])return t.signIn();t.signUp()})),t.link.addEventListener("click",(()=>{"login"===t.form.classList[1]?t.changeToRegisterForm():t.changeToLoginForm()})),t.loginInput.addEventListener("click",(()=>{t.loginInput.style.borderColor=""})),t.passInput.addEventListener("click",(()=>{t.passInput.style.borderColor=""}))},changeToRegisterForm:function(){t.form.classList.remove("login"),t.form.classList.add("register"),t.link.textContent="Already registered? Sing in",t.header.textContent="Register",t.button.value="Register"},changeToLoginForm:function(){t.form.classList.remove("register"),t.form.classList.add("login"),t.link.textContent="New user? Sign up",t.header.textContent="Login",t.button.value="Login"},signIn:function(){const e=t.loginInput.value,s=t.passInput.value;if(""===e)t.loginInput.style.borderColor="red",alert("Please, enter your login!");else if(""===s)t.passInput.style.borderColor="red",alert("Please, enter your password!");else if(null==localStorage.getItem(e))t.loginInput.style.borderColor="red",alert("Username is not correct! Check your username or register!");else{if(JSON.parse(localStorage.getItem(e)).pass===s)return t.completedAuth();t.passInput.style.borderColor="red",alert("Password is wrong!")}},alwaysTwoDigits:function(e){return 1===String(e).length?"0"+e:e},signUp:function(){const e=t.loginInput.value,s=t.passInput.value;if(""===e)alert("Please, enter your login!");else if(""===s)alert("Please, enter your password!");else if(null==localStorage.getItem(e)){const a=new Date;let o=`${t.alwaysTwoDigits(a.getDate())}/${t.alwaysTwoDigits(a.getMonth()+1)}/${t.alwaysTwoDigits(a.getFullYear())} ${t.alwaysTwoDigits(a.getHours())}:${t.alwaysTwoDigits(a.getMinutes())}:${t.alwaysTwoDigits(a.getSeconds())}`;localStorage.setItem(e,JSON.stringify({pass:s,regDate:o})),t.loginInput.value="",t.passInput.value="",alert("Registration was successful! Log in!"),t.changeToLoginForm()}else alert("This user is already registered! Try logging in!"),t.loginInput.style.borderColor="red"},completedAuth:function(){t.authAs=t.loginInput.value,t.loginInput.value="",t.passInput.value="",t.form.style.display="none",alert("Succsesed login!"),localStorage.setItem("isAuth",!0),localStorage.setItem("authAs",t.authAs),n.isAuth=!0,n.loggedIn(t.authAs)}},s=t,a={authAs:"",account:document.querySelector(".console"),headerUserName:document.querySelector(".navbar-brand"),btnLogOut:document.querySelector("#log-out-btn"),mainUserName:document.querySelector("#username"),userRegData:document.querySelector("#userRegData"),table:document.querySelector("#table-data"),init:e=>{a.account.style.display="block",a.authAs=e,a.addEventListeners(),a.render()},addEventListeners:()=>{a.btnLogOut.addEventListener("click",(()=>{a.isAuth=!1,a.authAs="",n.authAs=a.authAs,a.account.style.display="none",localStorage.setItem("isAuth",a.isAuth),localStorage.setItem("authAs",a.authAs),n.loggedOut()}))},render:()=>{a.headerUserName.textContent=a.authAs,a.mainUserName.textContent=a.authAs,a.userRegData.textContent=JSON.parse(localStorage.getItem(a.authAs)).regDate,a.createUserList(),document.querySelector(".activeUserBtn").addEventListener("click",a.openModal),document.querySelector("#changePassBtn").addEventListener("click",a.changePassword)},createUserList:()=>{const e=Object.keys(localStorage);e.splice(e.indexOf("isAuth"),1),e.splice(e.indexOf("authAs"),1),e.forEach(((e,t)=>{t++;const s=document.createElement("tr");e==a.authAs&&s.classList.add("table-success"),s.innerHTML=`<th scope="row" class="user-number">${t}</th>\n      <td class="user-email">${e}</td>\n      <td class="user-reg-date">${JSON.parse(localStorage.getItem(e)).regDate}</td>\n      <td class="edit">\n      \n      <button type="button" ${e==a.authAs?"":"disabled"} class="btn btn-${e==a.authAs?"primary activeUserBtn":"danger"}" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="${e}">edit</button>\n\n      </td>`,a.table.append(s)}))},openModal:()=>{const e=document.querySelector(".modal").querySelector("#user-email");e.value=a.authAs,e.setAttribute("disabled",!0);const t=document.querySelector("#changePassBtn");t.removeAttribute("disabled"),t.classList.remove("btn-secondary"),t.classList.add("btn-primary"),document.querySelector("#closeBtn").classList.remove("btn-primary"),document.querySelector("#closeBtn").classList.add("btn-secondary")},changePassword:()=>{const e=document.querySelector("#new-password"),t=document.querySelector("#re-new-password");if(t.addEventListener("click",(()=>{t.style.borderColor=""})),e.value!=t.value||""===e.value)t.style.borderColor="red",alert("Passwords don't match, check again!");else{const s=JSON.parse(localStorage.getItem(a.authAs));s.pass=e.value;const o=JSON.stringify(s);localStorage.setItem(a.authAs,o),e.value="",t.value="";const r=document.querySelector("#changePassBtn");r.setAttribute("disabled",!0),r.classList.remove("btn-primary"),r.classList.add("btn-secondary"),document.querySelector("#closeBtn").classList.remove("btn-secondary"),document.querySelector("#closeBtn").classList.add("btn-primary"),alert("Password changed successfully!")}}},o=a,r={isAuth:!1,authAs:"",init:()=>{"true"==localStorage.getItem("isAuth")?(r.isAuth=!0,r.authAs=localStorage.getItem("authAs")):"false"==localStorage.getItem("isAuth")&&(r.isAuth=!1),r.isAuth?(s.form.style.display="none",r.loggedIn(r.authAs)):r.loggedOut()},loggedIn:e=>{o.init(e)},loggedOut:()=>{s.init()}};r.init();const n=r})();